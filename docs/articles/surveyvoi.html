<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>surveyvoi: Survey Value of Information • surveyvoi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="surveyvoi: Survey Value of Information">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveyvoi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/surveyvoi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/prioritizr/surveyvoi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>surveyvoi: Survey Value of Information</h1>
                        <h4 data-toc-skip class="author">Jeffrey O.
Hanson</h4>
            
            <h4 data-toc-skip class="date">2024-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/prioritizr/surveyvoi/blob/HEAD/vignettes/surveyvoi.Rmd"><code>vignettes/surveyvoi.Rmd</code></a></small>
      <div class="d-none name"><code>surveyvoi.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The funding available for conservation is limited. To ensure that
conservation funds are allocated cost-effectively, conservation plans
(termed prioritizations) can be developed – using a combination of
economic, biodiversity, and land-use data – to prioritize a set of sites
for conservation management (e.g. protected area establishment).
However, existing data on biodiversity patterns are incomplete. As a
consequence, prioritizations can potentially be improved by collecting
additional data. Specifically, ecological surveys can be conducted in
sites to learn more about which species are present within them.
However, conducting ecological surveys reduces the funds available for
conservation management. Thus, decision makers need to strategically
allocate funding for surveying sites and managing them for
conservation—this is not a trivial task.</p>
<p>The <em>surveyvoi R</em> package is a decision support tool for
prioritizing sites for ecological surveys based on their potential to
improve plans for conserving biodiversity (e.g. plans for establishing
protected areas). Given a set of sites that could potentially be
acquired for conservation management – wherein some sites have
previously been surveyed and other sites have not – it can be used to
generate and evaluate plans for additional surveys. Specifically, plans
for ecological surveys can be generated using various conventional
approaches (e.g. maximizing expected species richness, geographic
coverage, diversity of sampled environmental conditions) and directly
maximizing value of information using optimization algorithms. After
generating plans for surveys, they can also be evaluated using value of
information analysis. Please note that several functions depend on the
‘Gurobi’ optimization software (available from <a href="https://www.gurobi.com" class="external-link uri">https://www.gurobi.com</a>)
and the <em>gurobi R</em> package (<a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer" class="external-link">installation
instructions available for online Linux, Windows, and Mac OS</a>).</p>
<p>This tutorial provides a brief overview of the <em>surveyvoi R</em>
package. Here, we will simulate survey data, fit statistical models to
characterize the spatial distribution of a simulated species, and
generate and evaluate survey schemes based on different approaches.
Although this tutorial deals with only a single simulated species – to
keep the tutorial simple and reduce computational burden – the functions
used in this tutorial are designed to work with multiple species. If you
want to learn more about a specific function, please consult the
documentation written specifically for the function (accessible using
the R code <code>?function</code>, where <code>function</code> is the
name of desired function).</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Let’s start by setting up our R session. Here we will load some R
packages and pre-set the random number generators for
reproducibility.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prioritizr.github.io/surveyvoi/" class="external-link">surveyvoi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set RNG seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set default table printing options</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>pillar.sigfig <span class="op">=</span> <span class="fl">6</span>, tibble.width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-data">Simulate data<a class="anchor" aria-label="anchor" href="#simulate-data"></a>
</h2>
<p>Let’s simulate some data. To keep things simple, we will simulate
data for 30 sites and one conservation feature (e.g. species). Of the 30
sites in total, we will simulate survey data for 15 sites—meaning that
15 of the sites will not have survey data. We will also simulate three
spatially auto-correlated variables to characterize the environmental
conditions within the sites. Although the simulation code
(i.e. <code>simulate_site_data</code>) can output the probability that
features are expected to inhabit the sites, we will disable this option
to make our simulation study more realistic and instead predict these
probabilities using statistical models.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate site data</span></span>
<span><span class="va">site_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_site_data.html">simulate_site_data</a></span><span class="op">(</span></span>
<span>  n_sites <span class="op">=</span> <span class="fl">30</span>, n_features <span class="op">=</span> <span class="fl">1</span>, proportion_of_sites_missing_data <span class="op">=</span> <span class="fl">15</span> <span class="op">/</span> <span class="fl">30</span>,</span>
<span>  n_env_vars <span class="op">=</span> <span class="fl">3</span>, survey_cost_intensity <span class="op">=</span> <span class="fl">5</span>, management_cost_intensity <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>  max_number_surveys_per_site <span class="op">=</span> <span class="fl">1</span>, output_probabilities <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print site data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">site_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 30 features and 7 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 0.07758767 ymin: 0.03189323 xmax: 0.9762666 ymax: 0.9557619</span></span>
<span><span class="co">## CRS:           NA</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 30 × 8</span></span></span>
<span><span class="co">##    survey_cost management_cost    f1    n1        e1        e2         e3</span></span>
<span><span class="co">##          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>           9            <span style="text-decoration: underline;">2</span>458     0     0  0.334<span style="text-decoration: underline;">113</span>  0.502<span style="text-decoration: underline;">778</span> -<span style="color: #BB0000;">1.000</span><span style="color: #BB0000; text-decoration: underline;">12</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>           1            <span style="text-decoration: underline;">2</span>524     0     1 -<span style="color: #BB0000;">1.327</span><span style="color: #BB0000; text-decoration: underline;">16</span>  -<span style="color: #BB0000;">1.198</span><span style="color: #BB0000; text-decoration: underline;">93</span>   1.064<span style="text-decoration: underline;">94</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>           3            <span style="text-decoration: underline;">2</span>483     0     0 -<span style="color: #BB0000;">1.183</span><span style="color: #BB0000; text-decoration: underline;">85</span>   0.676<span style="text-decoration: underline;">827</span>  0.387<span style="text-decoration: underline;">451</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>          12            <span style="text-decoration: underline;">2</span>513     0     0  0.691<span style="text-decoration: underline;">077</span> -<span style="color: #BB0000;">0.926</span><span style="color: #BB0000; text-decoration: underline;">471</span> -<span style="color: #BB0000;">0.244</span><span style="color: #BB0000; text-decoration: underline;">236</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>           4            <span style="text-decoration: underline;">2</span>477     0     0  0.832<span style="text-decoration: underline;">864</span>  2.705<span style="text-decoration: underline;">43</span>  -<span style="color: #BB0000;">0.351</span><span style="color: #BB0000; text-decoration: underline;">963</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>           8            <span style="text-decoration: underline;">2</span>481     0     1 -<span style="color: #BB0000;">0.870</span><span style="color: #BB0000; text-decoration: underline;">905</span> -<span style="color: #BB0000;">0.635</span><span style="color: #BB0000; text-decoration: underline;">214</span> -<span style="color: #BB0000;">0.779</span><span style="color: #BB0000; text-decoration: underline;">346</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>           1            <span style="text-decoration: underline;">2</span>499     1     1  0.774<span style="text-decoration: underline;">926</span>  1.310<span style="text-decoration: underline;">91</span>  -<span style="color: #BB0000;">0.010</span><span style="color: #BB0000; text-decoration: underline;">434</span><span style="color: #BB0000;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>           6            <span style="text-decoration: underline;">2</span>479     0     0  1.346<span style="text-decoration: underline;">95</span>   0.220<span style="text-decoration: underline;">259</span>  0.824<span style="text-decoration: underline;">172</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>           7            <span style="text-decoration: underline;">2</span>484     0     1 -<span style="color: #BB0000;">0.670</span><span style="color: #BB0000; text-decoration: underline;">210</span> -<span style="color: #BB0000;">0.729</span><span style="color: #BB0000; text-decoration: underline;">128</span> -<span style="color: #BB0000;">0.912</span><span style="color: #BB0000; text-decoration: underline;">692</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>          11            <span style="text-decoration: underline;">2</span>519     0     0  0.125<span style="text-decoration: underline;">632</span>  0.313<span style="text-decoration: underline;">454</span> -<span style="color: #BB0000;">1.374</span><span style="color: #BB0000; text-decoration: underline;">48</span>  </span></span>
<span><span class="co">##                geometry</span></span>
<span><span class="co">##                 <span style="color: #949494; font-style: italic;">&lt;POINT&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  (0.683582 0.841256)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  (0.872904 0.240454)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  (0.690117 0.679761)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (0.115936 0.0704436)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  (0.195009 0.646561)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  (0.461201 0.102122)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  (0.203535 0.955762)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  (0.590849 0.748232)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  (0.373888 0.150227)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  (0.141298 0.307626)</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 20 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the spatial location of the sites</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">site_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Sites"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-5-1.png" width="336" style="display: block; margin: auto;"></p>
<p>The <code>site_data</code> object is a spatially explicit dataset
(i.e. <code>sf</code> object) that contains information on the site
locations and additional site attributes. Here, each row corresponds to
a different site, and each column contains a different site attribute.
The <code>f1</code> column contains the results from previous surveys,
where values describe the proportion of previous surveys where species
were previously detected at each site. Since each site has had at most a
single previous survey, these data contain zeros (indicating that the
species has not been detected) and ones (indicating that the species has
been detected). The <code>n1</code> column contains the number of
previous surveys conducted within each site. Thus, sites with zeros in
this column have not previously been surveyed. The <code>e1</code>,
<code>e2</code>, and <code>e3</code> columns contain environmental
information for each site (e.g. normalized temperature and rainfall
data). The <code>survey_cost</code> column contains the cost of
surveying each site, and the <code>management_cost</code> column
contains the cost of managing each site for conservation.</p>
<p>To help understand the simulated data, let’s create some
visualizations.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot site occupancy data from previous surveys</span></span>
<span><span class="co"># 1 = species was detected in 100% of the previous surveys</span></span>
<span><span class="co"># 0 = species was detected in 0% of the previous surveys</span></span>
<span><span class="va">site_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"f"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Detection/non-detection data"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-6-1.png" width="336" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot number of previous surveys within each site</span></span>
<span><span class="va">site_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of previous surveys"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-7-1.png" width="336" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot site cost data</span></span>
<span><span class="co"># note that survey and management costs are on different scales</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">site_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">survey_cost</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_color_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Survey cost"</span>, x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">site_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">management_cost</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_color_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Management cost"</span>, x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot site environmental data</span></span>
<span><span class="va">site_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"e"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">var</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">var</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_color_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Environmental conditions"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-9-1.png" width="756" style="display: block; margin: auto;"></p>
<p>After simulating data for the sites, we will simulate data for the
conservation feature. We set
<code>proportion_of_survey_features = 1</code> to indicate that this
feature will be examined in future surveys.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate feature data</span></span>
<span><span class="va">feature_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_feature_data.html">simulate_feature_data</a></span><span class="op">(</span></span>
<span>  n_features <span class="op">=</span> <span class="fl">1</span>, proportion_of_survey_features <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove simulated model performance statistics since we will fit models below</span></span>
<span><span class="va">feature_data</span><span class="op">$</span><span class="va">model_sensitivity</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">feature_data</span><span class="op">$</span><span class="va">model_specificity</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># manually set target</span></span>
<span><span class="va">feature_data</span><span class="op">$</span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># print feature data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">feature_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   name  survey survey_sensitivity survey_specificity target</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> f1    TRUE             0.989<span style="text-decoration: underline;">102</span>           0.834<span style="text-decoration: underline;">741</span>      2</span></span></code></pre>
<p>The <code>feature_data</code> object is a table
(i.e. <code>tibble</code> object) that contains information on the
conservation feature. Here, each row corresponds to a different feature
– and so it only has one row because we only have one feature – and each
column contains different information about the feature(s). The
<code>name</code> column contains the name of the feature. The
<code>survey</code> column indicates if the feature will be examined in
future surveys. The <code>survey_sensitivity</code> and
<code>survey_specificity</code> columns denote the sensitivity
(probability of correctly recording a presence) and specificity
(probability of correctly recording an absence) of the survey
methodology. Finally, the <code>target</code> column specifies the
number of occupied sites for each species that should ideally be
represented in the prioritization.</p>
</div>
<div class="section level2">
<h2 id="modeling-probability-of-occupancy">Modeling probability of occupancy<a class="anchor" aria-label="anchor" href="#modeling-probability-of-occupancy"></a>
</h2>
<p>After simulating the data, we need to estimate the probability of the
feature occurring in the unsurveyed sites. This is important for
calculating the potential benefits of surveying sites, because if we can
reliably predict the probability of the feature(s) occurring in
unsurveyed sites using models, then we may not need to conduct any
additional surveys. Specifically, we will fit gradient boosted
regression trees – via the <a href="https://xgboost.readthedocs.io/en/latest/" class="external-link">xgboost R package</a>.
These models are well-suited for modeling species distributions because
they can accommodate high order interactions among different predictor
variables that are needed to effectively model species’ environmental
niches, even in the case of limited data. Furthermore, they can
incorporate knowledge of the sensitivity and specificity of previous
surveys during model fitting (using weights).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create list of candidate parameter values for calibration procedure</span></span>
<span><span class="va">xgb_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eta <span class="op">=</span> <span class="fl">0.1</span>, lambda <span class="op">=</span> <span class="fl">0.1</span>, objective <span class="op">=</span> <span class="st">"binary:logistic"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># identify suitable parameters for model fitting</span></span>
<span><span class="co"># ideally we would try a larger range of values (i.e. not just a single value of 0.1),</span></span>
<span><span class="co"># but we will keep it low to reduce processing time for this example</span></span>
<span><span class="va">xgb_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_xgb_occupancy_models.html">fit_xgb_occupancy_models</a></span><span class="op">(</span></span>
<span>  <span class="va">site_data</span>, <span class="va">feature_data</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f1"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e1"</span>, <span class="st">"e2"</span>, <span class="st">"e3"</span><span class="op">)</span>,</span>
<span>  <span class="st">"survey_sensitivity"</span>, <span class="st">"survey_specificity"</span>,</span>
<span>  n_folds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, xgb_tuning_parameters <span class="op">=</span> <span class="va">xgb_parameters</span><span class="op">)</span></span></code></pre></div>
<p>After fitting the models, we can examine the tuning parameters used
to fit the models, extract the modeled probability of occupancy, and
evaluate the performance of the models.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print best parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">xgb_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [[1]]$eta</span></span>
<span><span class="co">## [1] 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[1]]$lambda</span></span>
<span><span class="co">## [1] 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[1]]$objective</span></span>
<span><span class="co">## [1] "binary:logistic"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[1]]$scale_pos_weight</span></span>
<span><span class="co">## [[1]]$scale_pos_weight[[1]]</span></span>
<span><span class="co">## [1] 1 1</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print model performance (TSS value)</span></span>
<span><span class="va">xgb_performance</span> <span class="op">&lt;-</span> <span class="va">xgb_results</span><span class="op">$</span><span class="va">performance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">xgb_performance</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   feature train_tss_mean train_tss_std train_sensitivity_mean</span></span>
<span><span class="co">## 1      f1              1             0                      1</span></span>
<span><span class="co">##   train_sensitivity_std train_specificity_mean train_specificity_std</span></span>
<span><span class="co">## 1                     0                      1                     0</span></span>
<span><span class="co">##   test_tss_mean test_tss_std test_sensitivity_mean test_sensitivity_std</span></span>
<span><span class="co">## 1     0.7194687    0.2261671             0.9396965           0.08528208</span></span>
<span><span class="co">##   test_specificity_mean test_specificity_std</span></span>
<span><span class="co">## 1             0.7797722            0.3114492</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># store the model sensitivities and specificities in the feature_data object</span></span>
<span><span class="va">feature_data</span><span class="op">$</span><span class="va">model_sensitivity</span> <span class="op">&lt;-</span> <span class="va">xgb_performance</span><span class="op">$</span><span class="va">test_sensitivity_mean</span></span>
<span><span class="va">feature_data</span><span class="op">$</span><span class="va">model_specificity</span> <span class="op">&lt;-</span> <span class="va">xgb_performance</span><span class="op">$</span><span class="va">test_specificity_mean</span></span>
<span></span>
<span><span class="co"># store predicted probabilities in the site_data object</span></span>
<span><span class="va">xgb_predictions</span> <span class="op">&lt;-</span> <span class="va">xgb_results</span><span class="op">$</span><span class="va">predictions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">xgb_predictions</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 30 × 1</span></span></span>
<span><span class="co">##          f1</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 0.565<span style="text-decoration: underline;">847</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 0.410<span style="text-decoration: underline;">422</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 0.410<span style="text-decoration: underline;">541</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 0.452<span style="text-decoration: underline;">530</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 0.565<span style="text-decoration: underline;">847</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 0.410<span style="text-decoration: underline;">422</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 0.565<span style="text-decoration: underline;">847</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 0.565<span style="text-decoration: underline;">847</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 0.452<span style="text-decoration: underline;">463</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 0.565<span style="text-decoration: underline;">847</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 20 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site_data</span><span class="op">$</span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">xgb_predictions</span><span class="op">$</span><span class="va">f1</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot site-level estimated occupancy probabilities</span></span>
<span><span class="va">site_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_color_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Modeled probabilities"</span>, x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-13-1.png" width="336" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="expected-value-given-current-information">Expected value given current information<a class="anchor" aria-label="anchor" href="#expected-value-given-current-information"></a>
</h2>
<p>After simulating and modeling the data, we will now examine the
<em>expected value of the decision given current information</em>. This
value represents the conservation value of a near-optimal prioritization
given current information, whilst accounting for uncertainty in the
presence (and absence) of the conservation feature in each site.
Specifically, “current information” refers to our existing survey data
and our occupancy models. Next, we will set a total budget
(i.e. <code>total_budget</code>). This total budget represents the total
amount of resources available for surveying sites and managing them for
conservation. It will be set at 10% of the total site management
costs.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate total budget for surveying and managing sites</span></span>
<span><span class="va">total_budget</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">site_data</span><span class="op">$</span><span class="va">management_cost</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="co"># print total budget</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">total_budget</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7498.9</span></span></code></pre>
<p>Given the total budget, we can now calculate the <em>expected value
of the decision given current information</em>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># expected value of the decision given current information</span></span>
<span><span class="va">evd_current</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evdci.html">evdci</a></span><span class="op">(</span></span>
<span>  site_data <span class="op">=</span> <span class="va">site_data</span>,</span>
<span>  feature_data <span class="op">=</span> <span class="va">feature_data</span>,</span>
<span>  site_detection_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f1"</span><span class="op">)</span>,</span>
<span>  site_n_surveys_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1"</span><span class="op">)</span>,</span>
<span>  site_probability_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span><span class="op">)</span>,</span>
<span>  site_management_cost_column <span class="op">=</span> <span class="st">"management_cost"</span>,</span>
<span>  feature_survey_sensitivity_column <span class="op">=</span> <span class="st">"survey_sensitivity"</span>,</span>
<span>  feature_survey_specificity_column <span class="op">=</span> <span class="st">"survey_specificity"</span>,</span>
<span>  feature_model_sensitivity_column <span class="op">=</span> <span class="st">"model_sensitivity"</span>,</span>
<span>  feature_model_specificity_column <span class="op">=</span> <span class="st">"model_specificity"</span>,</span>
<span>  feature_target_column <span class="op">=</span> <span class="st">"target"</span>,</span>
<span>  total_budget <span class="op">=</span> <span class="va">total_budget</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evd_current</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9443835</span></span></code></pre>
<p>We can potentially improve the <em>expected value of the decision
given current information</em> by learning more about which sites are
more likely (and less likely) to contain the conservation feature.</p>
</div>
<div class="section level2">
<h2 id="survey-schemes">Survey schemes<a class="anchor" aria-label="anchor" href="#survey-schemes"></a>
</h2>
<p>Now we will generate some candidate survey schemes to see if we can
improve the management decision. To achieve this, we will set a budget
for surveying additional sites. Specifically, this survey budget
(i.e. <code>survey_budget</code>) will be set at 25% of the survey costs
for the unsurveyed sites. Note that our total budget must always be
greater than or equal to the survey budget.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate budget for surveying sites</span></span>
<span><span class="co">#   add column to site_data indicating if the sites already have data or not</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">surveyed</span> <span class="op">&lt;-</span> <span class="va">site_data</span><span class="op">$</span><span class="va">n1</span> <span class="op">&gt;</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co">#   add column to site_data containing the additional survey costs,</span></span>
<span><span class="co">#   i.e. sites that already have data have zero cost, and</span></span>
<span><span class="co">#   sites that are missing data retain their cost values</span></span>
<span><span class="va">site_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">site_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>new_survey_cost <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">surveyed</span>, <span class="fl">0</span>, <span class="va">survey_cost</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   calculate total cost of surveying remaining unsurveyed sites</span></span>
<span><span class="va">total_cost_of_surveying_remaining_sites</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">site_data</span><span class="op">$</span><span class="va">new_survey_cost</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   calculate budget for surveying sites</span></span>
<span><span class="va">survey_budget</span> <span class="op">&lt;-</span> <span class="va">total_cost_of_surveying_remaining_sites</span> <span class="op">*</span> <span class="fl">0.25</span></span>
<span></span>
<span><span class="co"># print budgets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">survey_budget</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30.75</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">total_budget</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7498.9</span></span></code></pre>
<p>We will generate survey schemes by selecting unsurveyed sites that
(i) increase geographic coverage among surveyed sites <span class="citation">(Yates 1948)</span>, (ii) increase coverage of
environmental conditions among surveyed sites [i.e. environmental
diversity; <span class="citation">Faith &amp; Walker (1996)</span>],
(iii) increase coverage of sites with highly uncertain information <span class="citation">(Guisan <em>et al.</em> 2006)</span>, (iv) increase
coverage of sites where species are predicted to occur <span class="citation">(Le Lay <em>et al.</em> 2010)</span>, and (v) increase
coverage of sites that have low management costs.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># (i) generate survey scheme to increase geographic coverage</span></span>
<span><span class="va">geo_scheme</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/geo_cov_survey_scheme.html">geo_cov_survey_scheme</a></span><span class="op">(</span></span>
<span>    <span class="va">site_data</span>, <span class="st">"new_survey_cost"</span>, <span class="va">survey_budget</span>, locked_out <span class="op">=</span> <span class="st">"surveyed"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (ii) generate survey scheme to increase environmental diversity,</span></span>
<span><span class="co"># environmental distances are calculated using Euclidean distances here,</span></span>
<span><span class="co"># though we might consider something like Mahalanobis distances for a</span></span>
<span><span class="co"># real dataset to account for correlations among environmental variables)</span></span>
<span><span class="va">env_scheme</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/env_div_survey_scheme.html">env_div_survey_scheme</a></span><span class="op">(</span></span>
<span>    <span class="va">site_data</span>, <span class="st">"new_survey_cost"</span>, <span class="va">survey_budget</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e1"</span>, <span class="st">"e2"</span>, <span class="st">"e3"</span><span class="op">)</span>,</span>
<span>    locked_out <span class="op">=</span> <span class="st">"surveyed"</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (iii) generate survey scheme using site uncertainty scores</span></span>
<span><span class="co"># calculate site uncertainty scores</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">uncertainty_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_site_uncertainty_scores.html">relative_site_uncertainty_scores</a></span><span class="op">(</span><span class="va">site_data</span>, <span class="st">"p1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate survey scheme</span></span>
<span><span class="va">unc_scheme</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/weighted_survey_scheme.html">weighted_survey_scheme</a></span><span class="op">(</span></span>
<span>    <span class="va">site_data</span>, <span class="st">"new_survey_cost"</span>, <span class="va">survey_budget</span>, <span class="st">"uncertainty_score"</span>,</span>
<span>    locked_out <span class="op">=</span> <span class="st">"surveyed"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (iv) generate survey scheme using lowest cost of site management</span></span>
<span><span class="co"># (i.e. inverse management cost)</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">inv_management_cost</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">site_data</span><span class="op">$</span><span class="va">management_cost</span></span>
<span><span class="va">cheap_scheme</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/weighted_survey_scheme.html">weighted_survey_scheme</a></span><span class="op">(</span></span>
<span>    <span class="va">site_data</span>, <span class="st">"new_survey_cost"</span>, <span class="va">survey_budget</span>, <span class="st">"inv_management_cost"</span>,</span>
<span>    locked_out <span class="op">=</span> <span class="st">"surveyed"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (v) generate survey scheme using site species richness scores</span></span>
<span><span class="co"># calculate site species richness scores</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">richness_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_site_richness_scores.html">relative_site_richness_scores</a></span><span class="op">(</span><span class="va">site_data</span>, <span class="st">"p1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate survey scheme</span></span>
<span><span class="va">rich_scheme</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/weighted_survey_scheme.html">weighted_survey_scheme</a></span><span class="op">(</span></span>
<span>    <span class="va">site_data</span>, <span class="st">"new_survey_cost"</span>, <span class="va">survey_budget</span>, <span class="st">"richness_score"</span>,</span>
<span>    locked_out <span class="op">=</span> <span class="st">"surveyed"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s visualize the different survey schemes.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add schemes to site_data</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">geo_scheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">geo_scheme</span><span class="op">)</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">env_scheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">env_scheme</span><span class="op">)</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">unc_scheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">unc_scheme</span><span class="op">)</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">cheap_scheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cheap_scheme</span><span class="op">)</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">rich_scheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rich_scheme</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the schemes</span></span>
<span><span class="va">site_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"scheme"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="va">is.logical</span>, <span class="va">as.character</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">name</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-21-1.png" width="604.8" style="display: block; margin: auto;"></p>
<p>We can see that different approaches yield different survey schemes –
but how well do they perform?</p>
</div>
<div class="section level2">
<h2 id="expected-value-of-the-decision-given-sample-information">Expected value of the decision given sample information<a class="anchor" aria-label="anchor" href="#expected-value-of-the-decision-given-sample-information"></a>
</h2>
<p>Now that we’ve generated the survey schemes, let’s calculate the
<em>expected value of the decision given sample information</em> for
each survey scheme.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create table to store results</span></span>
<span><span class="va">evd_survey_schemes</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_scheme"</span>, <span class="st">"env_scheme"</span>, <span class="st">"unc_scheme"</span>, <span class="st">"cheap_scheme"</span>,</span>
<span>                  <span class="st">"rich_scheme"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># expected value of the decision given each survey scheme</span></span>
<span><span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>  <span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">name</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/evdsi.html">evdsi</a></span><span class="op">(</span></span>
<span>      site_data <span class="op">=</span> <span class="va">site_data</span>,</span>
<span>      feature_data <span class="op">=</span> <span class="va">feature_data</span>,</span>
<span>      site_detection_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f1"</span><span class="op">)</span>,</span>
<span>      site_n_surveys_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1"</span><span class="op">)</span>,</span>
<span>      site_probability_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span><span class="op">)</span>,</span>
<span>      site_survey_scheme_column <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>      site_management_cost_column <span class="op">=</span> <span class="st">"management_cost"</span>,</span>
<span>      site_survey_cost_column <span class="op">=</span> <span class="st">"survey_cost"</span>,</span>
<span>      feature_survey_column <span class="op">=</span> <span class="st">"survey"</span>,</span>
<span>      feature_survey_sensitivity_column <span class="op">=</span> <span class="st">"survey_sensitivity"</span>,</span>
<span>      feature_survey_specificity_column <span class="op">=</span> <span class="st">"survey_specificity"</span>,</span>
<span>      feature_model_sensitivity_column <span class="op">=</span> <span class="st">"model_sensitivity"</span>,</span>
<span>      feature_model_specificity_column <span class="op">=</span> <span class="st">"model_specificity"</span>,</span>
<span>      feature_target_column <span class="op">=</span> <span class="st">"target"</span>,</span>
<span>      total_budget <span class="op">=</span> <span class="va">total_budget</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evd_survey_schemes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">##   name            value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> geo_scheme   0.981<span style="text-decoration: underline;">973</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> env_scheme   0.986<span style="text-decoration: underline;">738</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> unc_scheme   0.986<span style="text-decoration: underline;">738</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> cheap_scheme 0.993<span style="text-decoration: underline;">256</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> rich_scheme  0.988<span style="text-decoration: underline;">133</span></span></span></code></pre>
<p>We can also calculate how much the information gained from each of
the survey schemes is expected to improve the management decision. This
quantity is called the <em>expected value of sample information
(EVSI)</em> for each survey scheme.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate expected value of sample information for each survey scheme</span></span>
<span><span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">evsi</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">value</span> <span class="op">-</span> <span class="va">evd_current</span></span>
<span></span>
<span><span class="co"># print values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evd_survey_schemes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   name            value      evsi</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> geo_scheme   0.981<span style="text-decoration: underline;">973</span> 0.037<span style="text-decoration: underline;">589</span>6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> env_scheme   0.986<span style="text-decoration: underline;">738</span> 0.042<span style="text-decoration: underline;">354</span>6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> unc_scheme   0.986<span style="text-decoration: underline;">738</span> 0.042<span style="text-decoration: underline;">354</span>6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> cheap_scheme 0.993<span style="text-decoration: underline;">256</span> 0.048<span style="text-decoration: underline;">872</span>7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> rich_scheme  0.988<span style="text-decoration: underline;">133</span> 0.043<span style="text-decoration: underline;">749</span>9</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the expected value of sample information for each survey scheme</span></span>
<span><span class="co"># color the best survey scheme in blue</span></span>
<span><span class="va">evd_survey_schemes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">name</span>, levels <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span>
<span>         is_best <span class="op">=</span> <span class="va">evsi</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">evsi</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">evsi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">is_best</span>, color <span class="op">=</span> <span class="va">is_best</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Survey scheme"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Expected value of sample information"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"#3366FF"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"#3366FF"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-23-1.png" width="504" style="display: block; margin: auto;"></p>
<p>In this particular simulation, we can see that all of the survey
schemes have a low expected value of sample information (i.e. most
values are close to zero). This means that none of these survey schemes
would likely lead to a substantially better conservation outcome when
considering the funds spent on conducting them. If the survey schemes
had negative values, then this means that they would be expected to
poorer conservation outcomes than simply using existing information. We
can see that surveying sites with the cheapest management costs is the
best strategy – in this particular situation – because it has the
highest expected value of sample information, but can we do even better
with a different scheme?</p>
</div>
<div class="section level2">
<h2 id="optimized-survey-scheme">Optimized survey scheme<a class="anchor" aria-label="anchor" href="#optimized-survey-scheme"></a>
</h2>
<p>Now let’s generate an optimized survey scheme by directly maximizing
the <em>expected value of the decision given a survey scheme</em>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate optimized survey scheme(s)</span></span>
<span><span class="va">opt_scheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/approx_near_optimal_survey_scheme.html">approx_near_optimal_survey_scheme</a></span><span class="op">(</span></span>
<span>    site_data <span class="op">=</span> <span class="va">site_data</span>,</span>
<span>    feature_data <span class="op">=</span> <span class="va">feature_data</span>,</span>
<span>    site_detection_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f1"</span><span class="op">)</span>,</span>
<span>    site_n_surveys_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1"</span><span class="op">)</span>,</span>
<span>    site_probability_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span><span class="op">)</span>,</span>
<span>    site_management_cost_column <span class="op">=</span> <span class="st">"management_cost"</span>,</span>
<span>    site_survey_cost_column <span class="op">=</span> <span class="st">"survey_cost"</span>,</span>
<span>    feature_survey_column <span class="op">=</span> <span class="st">"survey"</span>,</span>
<span>    feature_survey_sensitivity_column <span class="op">=</span> <span class="st">"survey_sensitivity"</span>,</span>
<span>    feature_survey_specificity_column <span class="op">=</span> <span class="st">"survey_specificity"</span>,</span>
<span>    feature_model_sensitivity_column <span class="op">=</span> <span class="st">"model_sensitivity"</span>,</span>
<span>    feature_model_specificity_column <span class="op">=</span> <span class="st">"model_specificity"</span>,</span>
<span>    feature_target_column <span class="op">=</span> <span class="st">"target"</span>,</span>
<span>    total_budget <span class="op">=</span> <span class="va">total_budget</span>,</span>
<span>    survey_budget <span class="op">=</span> <span class="va">total_budget</span>,</span>
<span>    n_approx_replicates <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    n_approx_outcomes_per_replicate <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print number of optimized survey schemes</span></span>
<span><span class="co"># if there are multiple optimized survey schemes,</span></span>
<span><span class="co"># this means that multiple different survey schemes are likely to deliver</span></span>
<span><span class="co"># similar results (even if they select different sites for surveys)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">opt_scheme</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add first optimized scheme to site data</span></span>
<span><span class="va">site_data</span><span class="op">$</span><span class="va">opt_scheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">opt_scheme</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot optimized scheme</span></span>
<span><span class="va">site_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"opt_scheme"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">opt_scheme</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X coordinate"</span>, y <span class="op">=</span> <span class="st">"Y coordinate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-27-1.png" width="504" style="display: block; margin: auto;"></p>
<p>We can see that the optimized survey scheme (<code>opt_scheme</code>)
is different to the previous survey schemes.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate expected value of sample information for the optimized scheme</span></span>
<span><span class="va">evd_opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evdsi.html">evdsi</a></span><span class="op">(</span></span>
<span>    site_data <span class="op">=</span> <span class="va">site_data</span>,</span>
<span>    feature_data <span class="op">=</span> <span class="va">feature_data</span>,</span>
<span>    site_detection_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f1"</span><span class="op">)</span>,</span>
<span>    site_n_surveys_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1"</span><span class="op">)</span>,</span>
<span>    site_probability_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span><span class="op">)</span>,</span>
<span>    site_survey_scheme_column <span class="op">=</span> <span class="st">"opt_scheme"</span>,</span>
<span>    site_management_cost_column <span class="op">=</span> <span class="st">"management_cost"</span>,</span>
<span>    site_survey_cost_column <span class="op">=</span> <span class="st">"survey_cost"</span>,</span>
<span>    feature_survey_column <span class="op">=</span> <span class="st">"survey"</span>,</span>
<span>    feature_survey_sensitivity_column <span class="op">=</span> <span class="st">"survey_sensitivity"</span>,</span>
<span>    feature_survey_specificity_column <span class="op">=</span> <span class="st">"survey_specificity"</span>,</span>
<span>    feature_model_sensitivity_column <span class="op">=</span> <span class="st">"model_sensitivity"</span>,</span>
<span>    feature_model_specificity_column <span class="op">=</span> <span class="st">"model_specificity"</span>,</span>
<span>    feature_target_column <span class="op">=</span> <span class="st">"target"</span>,</span>
<span>    total_budget <span class="op">=</span> <span class="va">total_budget</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evd_opt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9934998</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># append optimized results to results table</span></span>
<span><span class="va">evd_survey_schemes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="va">evd_survey_schemes</span>,</span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"opt_scheme"</span>, value <span class="op">=</span> <span class="va">evd_opt</span>, evsi <span class="op">=</span> <span class="va">evd_opt</span> <span class="op">-</span> <span class="va">evd_current</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print updated results table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evd_survey_schemes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">##   name            value      evsi</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> geo_scheme   0.981<span style="text-decoration: underline;">973</span> 0.037<span style="text-decoration: underline;">589</span>6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> env_scheme   0.986<span style="text-decoration: underline;">738</span> 0.042<span style="text-decoration: underline;">354</span>6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> unc_scheme   0.986<span style="text-decoration: underline;">738</span> 0.042<span style="text-decoration: underline;">354</span>6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> cheap_scheme 0.993<span style="text-decoration: underline;">256</span> 0.048<span style="text-decoration: underline;">872</span>7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> rich_scheme  0.988<span style="text-decoration: underline;">133</span> 0.043<span style="text-decoration: underline;">749</span>9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> opt_scheme   0.993<span style="text-decoration: underline;">500</span> 0.049<span style="text-decoration: underline;">116</span>3</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize expected value of sample information</span></span>
<span><span class="co"># color the best survey scheme in blue</span></span>
<span><span class="va">evd_survey_schemes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">name</span>, levels <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span>
<span>         is_best <span class="op">=</span> <span class="va">evsi</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">evsi</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">evsi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">is_best</span>, color <span class="op">=</span> <span class="va">is_best</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Survey scheme"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Expected value of sample information"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"#3366FF"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"#3366FF"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-29-1.png" width="504" style="display: block; margin: auto;"></p>
<p>We can see that the optimized survey scheme has the highest
<em>expected value of sample information</em> of all the candidate
survey schemes. To better understand how sub-optimal the candidate
survey schemes are, let’s compute their relative performance and
visualize them.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># express values in terms of relative performance</span></span>
<span><span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">relative_performance</span> <span class="op">&lt;-</span></span>
<span>  <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">evsi</span><span class="op">)</span> <span class="op">-</span> <span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">evsi</span><span class="op">)</span> <span class="op">/</span></span>
<span>   <span class="va">evd_survey_schemes</span><span class="op">$</span><span class="va">evsi</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># visualize relative performance</span></span>
<span><span class="co"># zero = same performance as optimized scheme,</span></span>
<span><span class="co"># higher values indicate greater sub-optimality</span></span>
<span><span class="va">evd_survey_schemes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">name</span>, levels <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span>
<span>         relative_performance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">relative_performance</span><span class="op">)</span>,</span>
<span>         is_best <span class="op">=</span> <span class="va">relative_performance</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">relative_performance</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">relative_performance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">is_best</span>, color <span class="op">=</span> <span class="va">is_best</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Survey scheme"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Performance gap (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"#3366FF"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"#3366FF"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="surveyvoi_files/figure-html/unnamed-chunk-31-1.png" width="504" style="display: block; margin: auto;"></p>
<p>We can see that the optimized survey scheme performs better than the
other survey schemes. Although the optimized survey scheme doesn’t
provide a substantial improvement in this particular situation, we can
see how value of information analysis can potentially improve management
decisions by strategically allocating funds to surveys and conservation
management. Indeed, since we only considered a single species and a
handful of sites – to keep the tutorial simple and reduce computational
burden – it was unlikely that an optimized survey scheme would perform
substantially better than simply using current information. If you want
to try something more complex, try adapting the code in this tutorial to
simulate a larger number of sites and multiple species?</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Hopefully, this tutorial has been useful. If you have any questions
about using the <em>surveyvoi R</em> package or suggestions for
improving it, please file an issue on the package’s online coding
repository (<a href="https://github.com/prioritizr/surveyvoi/issues" class="uri">https://github.com/prioritizr/surveyvoi/issues</a>).</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-r2" class="csl-entry">
Faith, D.P. &amp; Walker, P. (1996). Environmental diversity: On the
best-possible use of surrogate data for assessing the relative
biodiversity of sets of areas. <em>Biodiversity &amp; Conservation</em>,
<em>5</em>, 399–415.
</div>
<div id="ref-r5" class="csl-entry">
Guisan, A., Broennimann, O., Engler, R., Vust, M., Yoccoz, N.G.,
Lehmann, A. &amp; Zimmermann, N.E. (2006). Using niche-based models to
improve the sampling of rare species. <em>Conservation Biology</em>,
<em>20</em>, 501–511.
</div>
<div id="ref-r4" class="csl-entry">
Le Lay, G., Engler, R., Franc, E. &amp; Guisan, A. (2010). Prospective
sampling based on model ensembles improves the detection of rare
species. <em>Ecography</em>, <em>33</em>, 1015–1027.
</div>
<div id="ref-r3" class="csl-entry">
Yates, F. (1948). Systematic sampling. <em>Philosophical Transactions of
the Royal Society of London. Series A, Mathematical and Physical
Sciences</em>, <em>241</em>, 345–377.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a>, <a href="http://www.iadine-chades.org" class="external-link">Iadine Chadès</a>, <a href="https://ejhudgins.com" class="external-link">Emma J Hudgins</a>, Joseph R Bennett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
